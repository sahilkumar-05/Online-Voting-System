@using static ONLINEVS_Project.Controllers.VotingController
@model List<PartyResultViewModel>

@{
    ViewData["Title"] = "Votes Casted Results";
}

<div class="container mt-4">

    <h1 class="fw-bold">Votes Casted Results</h1>
    <a asp-controller="Admin" asp-action="Dashboard" class="btn btn-secondary me-2">
        <i class="bi bi-house-door-fill"></i> Back to Dashboard
    </a>
    <!-- Download PDF Button -->
    <div class="mb-3">
        <a asp-action="VotesCastedResults"
           asp-route-downloadPdf="true"
           class="btn btn-danger">
            Download PDF
        </a>

    </div>
    @if (!Model.Any())
    {
        <div class="alert alert-warning">
            No votes casted yet for any election.
        </div>
    }
    else
    {
        @foreach (var party in Model)
        {
            <div class="card mb-4 shadow">
                <div class="card-header bg-primary text-white">
                    @* <h5 class="mb-0">@party.PartyName — Total Votes: @party.PartyTotalVotes</h5> *@
                    <h5 class="mb-0">
                        @party.PartyName — Total Votes: @party.PartyTotalVotes

                        @if (party.IsElectionEnded)
                        {
                            if (party.IsWinner)
                            {
                                <span class="badge bg-success ms-2">WINNER</span>
                            }
                            else
                            {
                                <span class="badge bg-danger ms-2">LOSER</span>
                            }
                        }
                        else
                        {
                            <span class="badge bg-secondary ms-2">ONGOING</span>
                        }
                    </h5>


                </div>

                <div class="card-body p-0">
                    <table class="table table-striped mb-0">
                        <thead>
                            <tr>
                                <th>Candidate Name</th>
                                <th>Election Title</th>
                                <th>Election Description</th>
                                <th>Total Votes</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var candidate in party.Candidates)
                            {
                                <tr>
                                    <td>@candidate.CandidateName</td>
                                    <td>@candidate.ElectionTitle</td>
                                    <td>@candidate.ElectionDescription</td>
                                    <td>@candidate.TotalVotes</td>
                                </tr>
                            }
                        </tbody>
                    </table>

                </div>
            </div>
           
        }
    }
</div>
